# Minimal Solutions to Generalized Three-View Relative Pose Problem

## Introduction
This repository hosts the source code of the paper: <br />
"Minimal Solutions to Generalized Three-View Relative Pose Problem" published in ICCV 2023 (oral presentation). [[Paper](https://openaccess.thecvf.com/content/ICCV2023/papers/Ding_Minimal_Solutions_to_Generalized_Three-View_Relative_Pose_Problem_ICCV_2023_paper.pdf)][[Supp](https://openaccess.thecvf.com/content/ICCV2023/supplemental/Ding_Minimal_Solutions_to_ICCV_2023_supplemental.pdf)] <br />
Two minimal cases for the generalized three-view relative pose problem were proposed: *(i)* the 4-point case and *(ii)* the 6-line case, which are both solved by [GPU-HC](https://github.com/C-H-Chien/Homotopy-Continuation-Tracker-on-GPU). It has shown to be more robust than the generalized two-view relative pose (which requires 6 points for a minimal case), and are efficient, *e.g.*, ~5.11 (ms) for the 6-line case and 4.77 for the 4-point case running on NVIDIA Titan V GPU. <br />
(Note that the timings reported here are a bit faster than what was reported in the paper because the performance of our GPU-HC solver has greatly improved.)

## Dependencies
(1) CMake 3.14 or higher <br />
(2) MAGMA 2.6.1 or higher (used for easy complex number computation on both CPU and GPU sides) <br />
(3) CUDA 11.X or higher <br />
(4) openBlas <br />
(5) YAML-CPP from [here](https://github.com/jbeder/yaml-cpp) (used to parse data from the .yaml file)

## Code Usage Instructions
### Build and Compile
Navigate to `GPU-HC/` and simply follow the standard build and compile steps, namely,
```bash
$ mkdir build && cd build 
$ cmake -DCMAKE_CUDA_ARCHITECTURES=XX ..
$ make -j
```
Note that
- `XX` is the compute capability of the GPU, _e.g._, 70, 75, 80, _etc_. This flag is optional, but adding it _may_ lead to a slight speedup.
- Change the include directories and linked library paths in the `CMakeLists.txt` files under `GPU-HC/` and `GPU-HC/magmaHC/`.

### Execute
Once the compilation is successful, navigate to `build/bin` where the execution file resides. Run the code with specified problem by
```bash
./magmaHC-main -p <problem-name>
```
where `<problem-name>` can be either `generalized_3views_4pts` or `generalized_3views_6lines`. The input structure follows the original [GPU-HC](https://github.com/Brown-LEMS/Homotopy-Continuation-Tracker-on-GPU) pattern.

## Synthetic Data
Synthetic data used to feed the solver is generated by ``synthetic-data/generate_*.m``. Basically it generates system target parameters, ground-truth relative rotations and translations, _etc_. You will find the order of the system target parameters so that it makes transmission from synthetic data to real-world data easy. <br />

## TODOs
- [ ] Document the rest of the files, code, _etc_.
- [ ] Add a RANSAC scheme based on the framework of the [improved GPU-HC](https://github.com/Brown-LEMS/Trifocal_Pose_Estimation_using_Improved_GPUHC).
- [ ] Add a python binding and example code to faciliate an easy access by python users.

## Change Logs
All changes and update information reside in changelogs.md

## Reference
Please cite the paper if using the code: <br />
```
@InProceedings{Ding:etal:ICCV:2023,
    author    = {Ding, Yaqing and Chien, Chiang-Heng and Larsson, Viktor and \r{A}str\"om, Karl and Kimia, Benjamin},
    title     = {Minimal Solutions to Generalized Three-View Relative Pose Problem},
    booktitle = {Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV)},
    month     = {October},
    year      = {2023},
    pages     = {8156-8164}
}
```



